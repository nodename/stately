{"version":3,"sources":["nodename/stately/comms.cljs"],"mappings":"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","names":["nodename.stately.comms/re-frame-comms","nodename.stately.communications.re-frame-api/dispatch","nodename.stately.communications.re-frame-api/register-handler","nodename.stately.communications.re-frame-api/lookup-handler","nodename.stately.communications.re-frame-api/log","nodename.stately.communications.re-frame-api/warn","nodename.stately.communications.re-frame-api/error","nodename.stately.communications.re-frame-api/app-db","nodename.stately.comms/standalone-comms","nodename.stately.communications.standalone-api/dispatch","nodename.stately.communications.standalone-api/run-queue","nodename.stately.communications.standalone-api/register-handler","nodename.stately.communications.standalone-api/lookup-handler","nodename.stately.communications.standalone-api/log","nodename.stately.communications.standalone-api/warn","nodename.stately.communications.standalone-api/error","nodename.stately.communications.standalone-api/app-db","nodename.stately.comms/comms","cljs.core.atom","nodename.stately.comms/app-db","cljs.core/deref","nodename.stately.comms/set-comms!","new-comms","js/Error","cljs.core/empty?","clojure.set.difference","cljs.core/set","cljs.core/keys","cljs.core.swap_BANG_","cljs.core/merge","nodename.stately.comms/set-re-frame-comms!","nodename.stately.comms/set-standalone-comms!","nodename.stately.comms/use-re-frame!","yesno","nodename.stately.comms/dispatch","event-v","fexpr__45704","nodename.stately.comms/run-queue","fexpr__45709","var_args","G__45712","nodename.stately.comms/register-handler","id","handler","fexpr__45721","middleware","fexpr__45729","nodename.stately.comms/lookup-handler","event-id","fexpr__45751","args__5732__auto__","len__5726__auto__","i__5727__auto__","argseq__5733__auto__","cljs.core/IndexedSeq","nodename.stately.comms/log","seq45755","self__5712__auto__","cljs.core/seq","args","G__45765","fexpr__45764","nodename.stately.comms/warn","seq45773","G__45784","fexpr__45783","nodename.stately.comms/error","seq45789","G__45796","fexpr__45795"],"sourcesContent":["(ns nodename.stately.comms\n  (:require [nodename.stately.communications.standalone-api :as st]\n            [nodename.stately.communications.re-frame-api :as rf]\n            [clojure.set :refer [difference]]))\n\n\n(def re-frame-comms\n  {:dispatch rf/dispatch\n   :run-queue #()\n   :register-handler rf/register-handler\n   :lookup-handler rf/lookup-handler\n   :log rf/log\n   :warn rf/warn\n   :error rf/error\n   :app-db rf/app-db})\n\n(def standalone-comms\n  {:dispatch st/dispatch\n   :run-queue st/run-queue\n   :register-handler st/register-handler\n   :lookup-handler st/lookup-handler\n   :log st/log\n   :warn st/warn\n   :error st/error\n   :app-db st/app-db})\n\n(def comms (atom standalone-comms))\n(def app-db (:app-db @comms))\n\n(defn set-comms!\n  \"Change the set (subset?) of comms functions used by stately.\n  'new-comms' should be a map which looks like default-comms\"\n  [new-comms]\n  (assert (empty? (difference (set (keys new-comms)) (set (keys standalone-comms)))) \"Unknown keys in new-comms\")\n  (swap! comms merge new-comms)\n  (def app-db (:app-db @comms)))\n\n(defn set-re-frame-comms!\n  []\n  (set-comms! re-frame-comms))\n\n(defn set-standalone-comms!\n  []\n  (set-comms! standalone-comms))\n\n(defn use-re-frame!\n  [yesno]\n  (if yesno\n    (set-re-frame-comms!)\n    (set-standalone-comms!)))\n\n\n(defn dispatch\n  [event-v] ((:dispatch @comms) event-v))\n(defn run-queue\n  [] ((:run-queue @comms)))\n(defn register-handler\n  ([id handler]\n   ((:register-handler @comms) id handler))\n  ([id middleware handler]\n   ((:register-handler @comms) id middleware handler)))\n(defn lookup-handler\n  [event-id] ((:lookup-handler @comms) event-id))\n(defn log\n  [& args] ((:log @comms) [args]))\n(defn warn\n  [& args] ((:warn @comms) [args]))\n(defn error\n  [& args] ((:error @comms) [args]))\n"]}