{"version":3,"sources":["re_frame/subs.cljc"],"mappings":"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","names":["re-frame.subs/kind","js/Error","re-frame.registrar/kinds","re-frame.subs/query->reaction","cljs.core.atom","re-frame.subs/clear-subscription-cache!","seq__43779","cljs.core/seq","cljs.core/deref","chunk__43780","count__43781","i__43782","vec__43791","cljs.core.nth","temp__5804__auto__","cljs.core/chunked-seq?","c__5525__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/count","vec__43794","cljs.core/first","cljs.core/next","k","rxn","re-frame.interop/dispose!","cljs.core/not-empty","re_frame.loggers.console","re-frame.subs/clear-all-handlers!","re_frame.registrar.clear_handlers","p__43803","vec__43804","re-frame.subs/cache-key","query-id","query-v","dynv","re-frame.subs/cache-and-return","r","re-frame.interop/add-on-dispose!","re-frame.trace/is-trace-enabled?","*current-trace*-orig-val__43808","re-frame.trace/*current-trace*","*current-trace*-temp-val__43809","re-frame.trace/start-trace","end__12884__auto__","re-frame.interop/now","duration__12885__auto__","cljs.core.swap_BANG_","re-frame.trace/traces","cljs.core/conj","cljs.core.assoc","re-frame.trace/run-tracing-callbacks!","re-frame.utils/first-in-vector","re-frame.interop/reagent-id","query-cache","cljs.core/contains?","cljs.core.get","cljs.core.dissoc","re-frame.interop/debug-enabled?","new-trace__12886__auto__","cljs.core.merge","cljs.core.update","cljs.core/merge","var_args","G__43826","re-frame.subs/cache-lookup","re_frame.subs.cache_lookup","dyn-v","re-frame.subs/legacy-query-id","q","cljs.core/vector?","re-frame.subs/q-id","p1__43836#","cljs.core.some_fn","re-frame.subs/warn-when-not-reactive","re-frame.interop/reactive?","G__43847","re-frame.subs/subscribe","query","cljs.core/map?","*current-trace*-orig-val__43850","*current-trace*-temp-val__43851","temp__5802__auto__","cached","handler-fn","re_frame.registrar.get_handler","re-frame.db/app-db","*current-trace*-orig-val__43945","*current-trace*-temp-val__43946","not-reactive","cljs.core.remove","re-frame.interop/ratom?","dyn-vals","re-frame.interop/make-reaction","cljs.core.mapv","sub","G__43970","G__43971","G__43972","G__43985","G__43986","G__43987","re-frame.subs/map-vals","f","m","cljs.core.into","cljs.core/empty","cljs.core.map","p__43998","vec__43999","v","re-frame.subs/map-signals","signals","cljs.core/sequential?","re-frame.interop/deref?","re-frame.subs/to-seq","x","cljs.core/List","re-frame.subs/deref-input-signals","dereffed-signals","cljs.core.doall","args__5732__auto__","len__5726__auto__","i__5727__auto__","argseq__5733__auto__","cljs.core/IndexedSeq","re-frame.subs/sugar","seq44018","G__44019","G__44020","G__44021","self__5711__auto__","sub-fn","query?","args","vec__44026","vec__44029","error-header","op","comp-f","cljs.core/take-last","input-args","computation-fn","or__5002__auto__","cljs.core._EQ_","cljs.core/fn?","cljs.core/butlast","cljs.core/last","cljs.core.drop_last","G__44035","cljs.core/Keyword","db","_","vec__44036","seq__44037","first__44038","qs","cljs.core.apply","inputs-fn","G__44041","vec__44044","marker","pairs","cljs.core.partition","markers","cljs.core/second","cljs.core/every?","re-frame.subs/reg-sub","seq44052","G__44053","vec__44058","re-frame.registrar/register-handler","query-vec","subscriptions","reaction-id","reaction","*current-trace*-orig-val__44102","*current-trace*-temp-val__44103","subscription","G__44110","G__44111","G__44115","G__44116","cljs.core/reset!","dyn-vec","*current-trace*-orig-val__44123","*current-trace*-temp-val__44124","G__44131","G__44132","G__44133","G__44136","G__44137","G__44138"],"sourcesContent":["(ns re-frame.subs\n  (:require\n   [re-frame.db        :refer [app-db]]\n   [re-frame.interop   :refer [add-on-dispose! debug-enabled? make-reaction ratom? deref? dispose! reagent-id reactive?]]\n   [re-frame.loggers   :refer [console]]\n   [re-frame.utils     :refer [first-in-vector]]\n   [re-frame.registrar :refer [get-handler clear-handlers register-handler]]\n   [re-frame.trace     :as trace :include-macros true]))\n\n(def kind :sub)\n(assert (re-frame.registrar/kinds kind))\n\n;; -- cache -------------------------------------------------------------------\n;;\n;; De-duplicate subscriptions. If two or more equal subscriptions\n;; are concurrently active, we want only one handler running.\n;; Two subscriptions are \"equal\" if their query vectors test \"=\".\n(def query->reaction (atom {}))\n\n(defn clear-subscription-cache!\n  \"calls `on-dispose` for each cached item,\n   which will cause the value to be removed from the cache\"\n  []\n  (doseq [[k rxn] @query->reaction]\n    (dispose! rxn))\n  (if (not-empty @query->reaction)\n    (console :warn \"re-frame: The subscription cache isn't empty after being cleared\")))\n\n(defn clear-all-handlers!\n  \"Unregisters all existing subscription handlers\"\n  []\n  (clear-handlers kind)\n  (clear-subscription-cache!))\n\n(defn cache-key\n  \"Constructs a cache-key that is compatible with re-frame.subs/alpha. That way,\n  an alpha subscription can look up the cached reaction of a core subscription, rather\n  that needing to recalculate. Since this is core, we don't actually support lifecycles here.\n  That's why `:reactive` is hard-coded, even though the user may have declared a lifecycle.\"\n  [[query-id :as query-v] dynv]\n  [{:re-frame/query-v   query-v\n    :re-frame/q         query-id\n    :re-frame/lifecycle :reactive}\n   dynv])\n\n(defn cache-and-return\n  \"cache the reaction r\"\n  [query-v dynv r]\n  (let [k (cache-key query-v dynv)]\n    ;; when this reaction is no longer being used, remove it from the cache\n    (add-on-dispose! r #(trace/with-trace {:operation (first-in-vector query-v)\n                                           :op-type   :sub/dispose\n                                           :tags      {:query-v  query-v\n                                                       :reaction (reagent-id r)}}\n                          (swap! query->reaction\n                                 (fn [query-cache]\n                                   (if (and (contains? query-cache k) (identical? r (get query-cache k)))\n                                     (dissoc query-cache k)\n                                     query-cache)))))\n    ;; cache this reaction, so it can be used to deduplicate other, later \"=\" subscriptions\n    (swap! query->reaction (fn [query-cache]\n                             (when debug-enabled?\n                               (when (contains? query-cache k)\n                                 (console :warn \"re-frame: Adding a new subscription to the cache while there is an existing subscription in the cache\" k)))\n                             (assoc query-cache k r)))\n    (trace/merge-trace! {:tags {:reaction (reagent-id r)}})\n    r)) ;; return the actual reaction\n\n(defn cache-lookup\n  ([query-v]\n   (cache-lookup query-v []))\n  ([query-v dyn-v]\n   (get @query->reaction (cache-key query-v dyn-v))))\n\n;; -- subscribe ---------------------------------------------------------------\n\n;; this duplicates re-frame.query.alpha/legacy-query-id.\n;; included here for forward compatibility, since an alpha sub can depend on a core sub.\n(defn legacy-query-id [q]\n  (when (vector? q) (first q)))\n\n;; this duplicates re-frame.query.alpha/id.\n;; included here for forward compatibility, since an alpha sub can depend on a core sub.\n(def q-id (some-fn legacy-query-id\n                 :re-frame/q\n                 #(console :error (str \"re-frame: can't find the query id. \"\n                                       \"expected a vector with at least one item, \"\n                                       \"or a :re-frame/q key, but got:\" %))))\n\n(defn warn-when-not-reactive\n  []\n  (when (and debug-enabled? (not (reactive?)))\n    (console :warn\n             \"re-frame: Subscribe was called outside of a reactive context.\\n\"\n             \"https://day8.github.io/re-frame/FAQs/UseASubscriptionInAnEventHandler/\")))\n\n(defn subscribe\n  ([query]\n   (if (map? query)\n     (console :error \"re-frame: can't pass a map to subscribe. Did you mean to use re-frame.alpha/sub?\")\n     (do\n       (warn-when-not-reactive)\n       (trace/with-trace {:operation (first-in-vector query)\n                          :op-type   :sub/create\n                          :tags      {:query-v query}}\n         (if-let [cached (cache-lookup query)]\n           (do\n             (trace/merge-trace! {:tags {:cached?  true\n                                         :reaction (reagent-id cached)}})\n             cached)\n\n           (let [query-id   (first-in-vector query)\n                 handler-fn (get-handler kind query-id)]\n             (trace/merge-trace! {:tags {:cached? false}})\n             (if (nil? handler-fn)\n               (do (trace/merge-trace! {:error true})\n                   (console :error (str \"re-frame: no subscription handler registered for: \" query-id \". Returning a nil subscription.\")))\n               (cache-and-return query [] (handler-fn app-db query)))))))))\n\n  ([query dynv]\n   (if (map? query)\n     (console :error \"re-frame: can't pass a map to subscribe. Did you mean to use re-frame.alpha/sub?\")\n     (do\n       (warn-when-not-reactive)\n       (trace/with-trace {:operation (first-in-vector query)\n                          :op-type   :sub/create\n                          :tags      {:query-v query\n                                      :dyn-v   dynv}}\n         (if-let [cached (cache-lookup query dynv)]\n           (do\n             (trace/merge-trace! {:tags {:cached?  true\n                                         :reaction (reagent-id cached)}})\n             cached)\n           (let [query-id   (first-in-vector query)\n                 handler-fn (get-handler kind query-id)]\n             (trace/merge-trace! {:tags {:cached? false}})\n             (when debug-enabled?\n               (when-let [not-reactive (not-empty (remove ratom? dynv))]\n                 (console :warn \"re-frame: your subscription's dynamic parameters that don't implement IReactiveAtom:\" not-reactive)))\n             (if (nil? handler-fn)\n               (do (trace/merge-trace! {:error true})\n                   (console :error (str \"re-frame: no subscription handler registered for: \" query-id \". Returning a nil subscription.\")))\n               (let [dyn-vals (make-reaction (fn [] (mapv deref dynv)))\n                     sub      (make-reaction (fn [] (handler-fn app-db query @dyn-vals)))]\n                 ;; handler-fn returns a reaction which is then wrapped in the sub reaction\n                 ;; need to double deref it to get to the actual value.\n                                        ;(console :log \"Subscription created: \" v dynv)\n                 (cache-and-return query dynv (make-reaction (fn [] @@sub))))))))))))\n\n;; -- reg-sub -----------------------------------------------------------------\n\n(defn- map-vals\n  \"Returns a new version of 'm' in which 'f' has been applied to each value.\n  (map-vals inc {:a 4, :b 2}) => {:a 5, :b 3}\"\n  [f m]\n  (into (empty m)\n        (map (fn [[k v]] [k (f v)]))\n        m))\n\n(defn map-signals\n  \"Runs f over signals. Signals may take several\n  forms, this function handles all of them.\"\n  [f signals]\n  (cond\n    (sequential? signals) (map f signals)\n    (map? signals) (map-vals f signals)\n    (deref? signals) (f signals)\n    :else '()))\n\n(defn to-seq\n  \"Coerces x to a seq if it isn't one already\"\n  [x]\n  (if (sequential? x)\n    x\n    (list x)))\n\n(defn deref-input-signals\n  [signals query-id]\n  (let [dereffed-signals (map-signals deref signals)]\n    (cond\n      (sequential? signals) (map deref signals)\n      (map? signals) (map-vals deref signals)\n      (deref? signals) (deref signals)\n      :else (console :error \"re-frame: in the reg-sub for\" query-id \", the input-signals function returns:\" signals))\n    (trace/merge-trace! {:tags {:input-signals (doall (to-seq (map-signals reagent-id signals)))}})\n    dereffed-signals))\n\n(defn sugar [query-id sub-fn query? & args]\n  (let [error-header (str \"re-frame: reg-sub for \" query-id \", \")\n        [op f :as comp-f] (take-last 2 args)\n        [input-args      ;; may be empty, or one signal fn, or pairs of  :<- / vector\n         computation-fn] (if (or (= 1 (count comp-f))\n                                 (fn? op)\n                                 (query? op))\n                           [(butlast args) (last args)]\n                           (let [args (drop-last 2 args)]\n                             (case op\n                               ;; return a function that calls the computation fn\n                               ;;  on the input signal, removing the query vector\n                               :->\n                               [args (fn [db _]\n                                       (f db))]\n                               ;; return a function that calls the computation fn\n                               ;;  on the input signal and the data in the query vector\n                               ;;  that is not the query-id\n                               :=>\n                               [args (fn [db q]\n                                       (if (map? q)\n                                         (f db q)\n                                         (let [[_ & qs] q]\n                                           (apply f db qs))))]\n                               ;; an incorrect keyword was passed\n                               (console :error error-header \"expected :-> or :=> as second to last argument, got:\" op))))\n        inputs-fn (case (count input-args)\n                    ;; no `inputs` function provided - give the default\n                    0 (fn\n                        ([_] app-db)\n                        ([_ _] app-db))\n\n                    ;; a single `inputs` fn\n                    1 (let [f (first input-args)]\n                        (when-not (fn? f)\n                          (console :error error-header \"2nd argument expected to be an inputs function, got:\" f))\n                        f)\n\n                    ;; one sugar pair\n                    2 (let [[marker q] input-args]\n                        (when-not (= :<- marker)\n                          (console :error error-header \"expected :<-, got:\" marker))\n                        (fn inp-fn\n                          ([_] (sub-fn q))\n                          ([_ _] (sub-fn q))))\n\n                    ;; multiple sugar pairs\n                    (let [pairs   (partition 2 input-args)\n                          markers (map first pairs)\n                          q       (map second pairs)]\n                      (when-not (and (every? #{:<-} markers) (every? query? q))\n                        (console :error error-header \"expected pairs of :<- and vectors, got:\" pairs))\n                      (fn inp-fn\n                        ([_] (map sub-fn q))\n                        ([_ _] (map sub-fn q)))))]\n    [inputs-fn computation-fn]))\n\n(defn reg-sub\n  [query-id & args]\n  (let [[inputs-fn computation-fn] (apply sugar query-id subscribe vector? args)]\n    (register-handler\n     kind\n     query-id\n     (fn subs-handler-fn\n       ([db query-vec]\n        (let [subscriptions (inputs-fn query-vec nil)\n              reaction-id   (atom nil)\n              reaction      (make-reaction\n                             (fn []\n                               (trace/with-trace {:operation (q-id query-vec)\n                                                  :op-type   :sub/run\n                                                  :tags      {:query-v    query-vec\n                                                              :reaction   @reaction-id}}\n                                 (let [subscription (computation-fn\n                                                     (deref-input-signals subscriptions query-id)\n                                                     query-vec)]\n                                   (trace/merge-trace! {:tags {:value subscription}})\n                                   subscription))))]\n\n          (reset! reaction-id (reagent-id reaction))\n          reaction))\n       ([db query-vec dyn-vec]\n        (let [subscriptions (inputs-fn query-vec dyn-vec)\n              reaction-id   (atom nil)\n              reaction      (make-reaction\n                             (fn []\n                               (trace/with-trace {:operation (q-id query-vec)\n                                                  :op-type   :sub/run\n                                                  :tags      {:query-v   query-vec\n                                                              :dyn-v     dyn-vec\n                                                              :reaction  @reaction-id}}\n                                 (let [subscription (computation-fn (deref-input-signals subscriptions query-id) query-vec dyn-vec)]\n                                   (trace/merge-trace! {:tags {:value subscription}})\n                                   subscription))))]\n\n          (reset! reaction-id (reagent-id reaction))\n          reaction))))))\n"],"x_google_ignoreList":[0]}