{"version":3,"sources":["nodename/stately/communications/impl/router.cljs"],"mappings":";AAMA,AAAKA,0DAAY,AAACC;AAElB;;;oEAAA,pEAAMC,gJAEHC;AAFH,AAGE,oBACE,AAAyBC;AAAW,OAAwBA,6BAAUD;;AADxE,oBAEE,AAA+BC;AAAW,OAA+BA,oCAAUD;;AAFrF,oBAGE,AAA4BC;AAAW,OAA2BA,gCAAUD;;AAH9E,oBAIE,AAA2BC;AAAW,OAA0BA,+BAAUD;;AAJ5E;;;;;;AAMF,wDAAA,xDAAME;AAAN,AAEE,IAAMC,OAAK;AAAA,AACE,IAAAC,mBAAA,AAAAN,mDAAA;AAAA,AAAA,AAAAO,kCAAA;AAAA,AAAA,IAAAC,mBAAA,iBAAAC,wBAAA,WAAAC;AAAA,AAAA,IAAAC,kBAAA,CAAAD,YAAA;AAAA,AAAA,GAAA,CAAAC,oBAAA;AAAA,IAAAD,kBAAAA;AAAA,AAAA,OAAAE,4CAAAF,gBAAA,IACoBX;;AADpB,GAAA,CAAAY,oBAAA;AAAA,IAAAE,aAAA,CAAAH,YAAA;IAAAI,aAAA,qDAAAD,rDAEKoB;IAFLlB,aAAA,AAGKd,kEAAsBI;IAH3BK,kBAAA,iBAAAM,iBAAAN;AAAA,AAAA,CAAAM,eAAA,OAAAF;;AAAAE;;AAAA,AAAA,OAAAC,6CAAAP,gBAAAK;;AAAA;;;;AAAA,AAAA;;;AAAA,AAAA,IAAAG,iBAAA,CAAA,KAAA,KAAA,KAAA,KAAA,KAAA,KAAA,KAAA;AAAA,AAAA,CAAAA,eAAA,OAAAC;;AAAA,CAAAD,eAAA,OAAA;;AAAAA;;gHAAAR;;AAAA,AAAA,IAAAU,2BAAA,iBAAA,AAAA;AAAA,AAAA,IAAAC,wBAAA,AAAAZ,sBAAAC;AAAA,AAAA,GAAA,AAAAY,mCAAAD,sBAAA;AAAA;;AAAAA;;;;gBAAA,IAAAE,oBAAAC;AAAA,AAAA,IAAAC,uBAAAf;AAAA,AAAA,CAAAe,qBAAA,OAAAF;;AAAAE;AAAA,GAAA,AAAAC,cAAA,CAAAhB,YAAA;AAAA,IAAAiB,uBAAAjB;AAAA,AAAA,CAAAiB,qBAAA,OAAA,AAAAC,gBAAA,CAAAlB,YAAA;;AAAAiB;AAAA,MAAAJ;;;AAAA;;AAAA,AAAA,GAAA,AAAAD,mCAAAF,yBAAA;AAAA,eAAAV;;;;AAAAU;;;;;uGAAAV;;;;;gHAAAA;;;;;;;;;IAAAmB,uBAAA,iBAAAC,iBAAA,AAAAtB;AAAA,AAAA,CAAAsB,eAAAC,AAAA,OAAAzB;;AAAAwB;;AAAA,AAAA,OAAAE,2DAAAH;;;AAAAvB;;AADb,AAKE,OAACD;;AAEL,uDAAA,vDAAM6B,sHACHC;AADH,AAEE,GAAI,YAAA,XAAMA;AACR,0IAAA,1IAACC;;AACD,AAACC,wDAAKtC,wDAAYoC;;;AAJtB","names":["nodename.stately.communications.impl.router/event-queue","cljs.core.async.chan","nodename.stately.communications.impl.router/requestAnimationFrame","callback","js/window","nodename.stately.communications.impl.router/run-queue","tick","c__10424__auto__","cljs.core.async.impl.dispatch/run","f__10425__auto__","switch__10329__auto__","state_54798","state_val_54799","cljs.core.async.impl.ioc-helpers/take!","inst_54794","inst_54795","inst_54796","statearr-54805","cljs.core.async.impl.ioc-helpers/return-chan","statearr-54809","state-machine__10330__auto__","ret-value__10331__auto__","result__10332__auto__","cljs.core/keyword-identical?","ex__10333__auto__","e54813","statearr-54814","cljs.core/seq","statearr-54815","cljs.core/first","state__10426__auto__","statearr-54817","cljs.core.async.impl.ioc-helpers/USER-START-IDX","cljs.core.async.impl.ioc-helpers/run-state-machine-wrapped","nodename.stately.communications.impl.handlers/handle","nodename.stately.communications.impl.router/dispatch","event-v","nodename.stately.communications.impl.logging.error","cljs.core.async.put_BANG_"],"sourcesContent":["(ns nodename.stately.communications.impl.router\n  (:require [cljs.core.async :refer [put! >! <! chan go alt!]]\n            [nodename.stately.communications.impl.logging :refer [warn error]]\n            [nodename.stately.communications.impl.handlers :refer [handle]]))\n\n\n(def event-queue (chan))\n\n(defn requestAnimationFrame\n  \"Cross-browser wrapper for requestAnimationFrame\"\n  [callback]\n  (cond\n    (.-requestAnimationFrame js/window) (.requestAnimationFrame js/window callback)\n    (.-webkitRequestAnimationFrame js/window) (.webkitRequestAnimiationFrame js/window callback)\n    (.-mozRequestAnimationFrame js/window) (.mozRequestAnimationFrame js/window callback)\n    (.-msRequestAnimationFrame js/window) (.msRequestAnimationFrame js/window callback)))\n\n(defn run-queue\n  []\n  (let [tick (fn tick []\n               (go\n                 (let [event-v (<! event-queue)]\n                   (handle event-v)\n                   (requestAnimationFrame tick))))]\n    (tick)))\n\n(defn dispatch\n  [event-v]\n  (if (nil? event-v)\n    (error \"\\\"dispatch\\\" is ignoring a nil event.\")\n    (put! event-queue event-v))\n  nil)\n\n"]}