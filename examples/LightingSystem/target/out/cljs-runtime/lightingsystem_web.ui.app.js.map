{"version":3,"sources":["lightingsystem_web/ui/app.cljs"],"mappings":";AAQA,2DAAA,3DAACA,oLAAuB,WAAKC,GAAGC;AAAR,AAAW,OAAA,qGAAgBD;;AACnD,2DAAA,3DAACD,8KAAuB,WAAKC,GAAGC;AAAR,AAAW,OAAA,+FAAaD;;AAEhD,+CAAA,2CAAA,2DAAA,WAAA,oEAAA,MAAA,yDAAA,UAAA,gEAAA,7WAAKE;AAML,iCAAA,jCAAMC,0EACHC;AADH,AAAA,0FAAA,mDAAA,2CAAA,uDAAA,wCAAA,mEAAA,iEAAA,uDAAA,gEAAA,gEAAA,uDAAA,iEAAA,4EAAA,0DAAA,yDAAA,sEAAA,yDAAA,2DAAA,4PAAA,OAAA,gBAAA,+GAAA,SAAA,OAAA,iBAAA,MAAA,QAAA,tJAMkC,CAAA,wFAAA,tBAA2B,cAAA,bAAGA,tVAE9B,sBAAA,kLAAA,tMAAM,cAAA,bAAMA,mBACV,CAAA,uEAAA,sEAAA,1FAAY,cAAA,bAAGA,qEACV,cAAA,bAAGA,6DAMV,sBAAA,OAAA,3BAAI,cAAA,bAAMA,6OACzC,yDAAA,ZAAKA;;AAER,AAAA,gCAAA,wCAAAC,xEAAMM;AAAN,AAAA,IAAAL,qBAAA;AAAA,AAAA,IAAAC,0BAAA,AAAA;AAAA,AAAA,IAAAC,wBAAA;;AAAA,AAAA,GAAA,CAAAA,wBAAAD;AAAA,AAAA,AAAAD,wBAAA,CAAA,UAAAE;;AAAA,eAAA,CAAAA,wBAAA;;;;AAAA;;;;AAAA,IAAAC,uBAAA,EAAA,CAAA,MAAA,AAAAH,4BAAA,AAAA,KAAAI,qBAAA,AAAAJ,yBAAA,KAAA,IAAA,OAAA;AAAA,AAAA,OAAAK,mEAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAAF;;;AAAA,AAAA,CAAA,qEAAA,uBAAAG,5FAAMD,gFACHa,MAAMC;AADT,AAAA,IAAAZ,aAAAD;IAAAE,aAAA,AAAAC,4CAAAF,WAAA,IAAA;IAAAC,iBAAA,AAAAE,4BAAAF;sBAAA,AAAAG,4CAAAH,eAAA,7EAC0BY;AAD1B,AAAA,0FAAA,yDAAA,2CAAA,6DAAA;AAAA,AAEwB,iDAAA,1CAACC,6HAAqBF;GAF9C,8EAAA,uDAAA,2CAAA,2DAAA,WAAA,yDAAA,MAAA,gEAAA,OAAA,iHAAA,sEAAA,MAAA,yDAAA,OAAA,mHAAA,9qBAGuBC,uXAIgB,mCAAA,UAAA,3BAAIA,mPAGJ,mCAAA,OAAA,xBAAIA,uFACJ,mCAAA,OAAA,xBAAIA,iDACxCF;;;AAZH,CAAA,wDAAA,xDAAMb;;AAAN;AAAA,CAAA,kDAAA,WAAAO,7DAAMP;AAAN,AAAA,IAAAQ,WAAA,AAAAC,gBAAAF;IAAAA,eAAA,AAAAG,eAAAH;IAAAI,WAAA,AAAAF,gBAAAF;IAAAA,eAAA,AAAAG,eAAAH;AAAA,AAAA,IAAAK,qBAAA;AAAA,AAAA,OAAAA,wDAAAJ,SAAAG,SAAAJ;;;AAAA,AAcA,uCAAA,vCAAMU;AAAN,AAEE,IAAMC,SAAW,sDAAA,mFAAA,zIAACC;IACZ1B,aAAW,sDAAA,mFAAA,zIAAC0B;AADlB,AAEE;AAAA,AAEE,IAAMC,gBAAgB,0BAAA,AAAAC,wBAAA,lDAACC,0CAAWJ;IAC5BK,wBAAgB,0BAAA,AAAAF,wBAAA,lDAACC,0CAAWJ;IAC5BM,mBAAgB,0BAAA,AAAAH,wBAAA,lDAACC,0CAAWJ;IAC5BO,uBAAgB,0BAAA,AAAAJ,wBAAA,lDAACC,0CAAWJ;IAC5BQ,KAAgB,iBAAAC,mBAAA,AAAAN,gBAAK5B;AAAL,AAAA,oBAAAkC;AAAAA;;AAAA;;;AAJtB,AAAA,0FAAA,mDAAA,2CAAA,uDAAA,2CAAA,mEAAA,aAAA,gEAAA,QAAA,yDAAA,YAAA,iEAAA,yBAAA,mFAAA,kDAAA,0BAAA,6HAAA,mFAAA,mDAAA,2CAAA,uDAAA,2CAAA,gEAAA,OAAA,mEAAA,OAAA,yDAAA,YAAA,yIAAA,mFAAA,mDAAA,2CAAA,uDAAA,2CAAA,gEAAA,OAAA,uDAAA,OAAA,sEAAA,6GAAA,mFAAA,mDAAA,2CAAA,uDAAA,2CAAA,iEAAA,UAAA,sEAAA,MAAA,2DAAA,OAAA,sEAAA,uBAAA,mFAAA,mDAAA,2CAAA,uDAAA,2CAAA,gEAAA,OAAA,uDAAA,OAAA,sEAAA,uBAAA,eAAA,mFAAA,mDAAA,2CAAA,uDAAA,2CAAA,gEAAA,OAAA,mEAAA,OAAA,sEAAA,oyEAAA,mFAAA,mDAAA,2CAAA,uDAAA,2CAAA,gEAAA,sBAAA,mFAAA,yDAAA,2CAAA,oGAAA,6DAAA,nwLAWInC,+BAAKkC,2iBAKsB,cAAA,UAAA,tBAAI,MAAA,LAAMA,6CACrC,cAAA,KAAA,jBAAI,MAAA,LAAMA,ohBAGV,CAAA,+DAAA,JAAoBA,wmDASnB,iBAAA,SAAA,yBAAA,iBAAA,lEAAMN,0BACAG,uDACP,iBAAA,mFAAA,mDAAA,iHAAA,eAAA,iEAAA,iHAAA,oBAAA,8EAAA,2CAAA,sGAAA,iHAAA,2BAAA,2FAAA,mFAAA,mDAAA,iHAAA,kBAAA,2EAAA,2CAAA,qGAAA,mFAAA,mDAAA,2CAAA,uDAAA,2CAAA,gEAAA,OAAA,uDAAA,OAAA,yDAAA,uHAAA,iHAAA,mBAAA,jlEAAIH,wOAEApB,iMACAA,2OAAuD,GAAKwB,sHAC5DxB,6WAEAA,sOAAmDyB,8gBAEnD,wBAAA,sCAAA,5DAAIA,gLAGJzB,+uBAGaT;AA7CrB,AA8CyB,OAACqC,iDAAO,AAACC;WA9ClC,qBAAA,mFAAA,yDAAA,2CAAA,oGAAA,6DAAA,1GAgDqBtC;AAhDrB,AAiDyB,OAACqC,iDAAO,sDAAA,AAAAP,+CAAA,uGAAA,uEAAA,nRAACS,sEAAQC;WAjD1C,aAAA,mFAAA,yDAAA,2CAAA,oGAAA,kGAAA,/IAmDqBxC,0GACGyC","names":["re_frame.core.reg_sub","db","_","lightingsystem-web.ui.app/small-button-style","lightingsystem-web.ui.app/bulb","brightness","var_args","args__5732__auto__","len__5726__auto__","i__5727__auto__","argseq__5733__auto__","cljs.core/IndexedSeq","lightingsystem-web.ui.app/btn","p__11253","vec__11254","map__11257","cljs.core.nth","cljs.core/--destructure-map","cljs.core.get","seq11250","G__11251","cljs.core/first","cljs.core/next","G__11252","self__5711__auto__","label","event","disabled?","nodename.stately.core/dispatch-transition","lightingsystem-web.ui.app/app-screen","active","re_frame.core.subscribe","manual?","cljs.core/deref","cljs.core/contains?","motion-sensing?","manual-on?","motion-active?","br","or__5002__auto__","cljs.pprint.pprint","nodename.stately.tree/tree","cljs.core.dissoc","nodename.stately.comms/app-db","cljs.user/show-active-states"],"sourcesContent":["(ns lightingsystem-web.ui.app\n  (:require [cljs.pprint :refer [pprint]]\n            [re-frame.core :refer [reg-sub subscribe]]\n            [nodename.stately.comms :refer [app-db]]\n            [nodename.stately.core :refer [dispatch-transition]]\n            [nodename.stately.tree :refer [tree]]\n            [cljs.user :refer [show-active-states]]))\n\n(reg-sub :active-states (fn [db _] (:active-states db)))\n(reg-sub :brightness    (fn [db _] (:brightness db)))\n\n(def small-button-style\n  {:padding      \"4px 10px\"\n   :margin-right \"6px\"\n   :cursor       \"pointer\"\n   :font-size    \"12px\"})\n\n(defn bulb\n  [brightness]\n  [:div {:style {:width           \"120px\"\n                 :height          \"120px\"\n                 :border-radius   \"50%\"\n                 :margin          \"24px auto\"\n                 :background      (str \"rgba(255, 220, 80, \" (/ brightness 100) \")\")\n                 :border          \"3px solid #ccc\"\n                 :box-shadow      (when (pos? brightness)\n                                    (str \"0 0 \" (* brightness 0.4) \"px \"\n                                         (* brightness 0.2) \"px rgba(255,220,80,0.8)\"))\n                 :transition      \"all 0.4s ease\"\n                 :display         \"flex\"\n                 :align-items     \"center\"\n                 :justify-content \"center\"\n                 :font-size       \"14px\"\n                 :color           (if (pos? brightness) \"#333\" \"#aaa\")}}\n   (str brightness \"%\")])\n\n(defn btn\n  [label event & [{:keys [disabled?]}]]\n  [:button {:on-click  #(dispatch-transition [event])\n            :disabled  disabled?\n            :style     {:padding       \"8px 16px\"\n                        :margin        \"4px\"\n                        :font-size     \"14px\"\n                        :cursor        (if disabled? \"default\" \"pointer\")\n                        :border-radius \"4px\"\n                        :border        \"none\"\n                        :background    (if disabled? \"#ddd\" \"#444\")\n                        :color         (if disabled? \"#aaa\" \"white\")}}\n   label])\n\n(defn app-screen\n  []\n  (let [active     (subscribe [:active-states])\n        brightness (subscribe [:brightness])]\n    (fn\n      []\n      (let [manual?         (contains? @active :lighting/manual)\n            motion-sensing? (contains? @active :lighting/motion-sensing)\n            manual-on?      (contains? @active :manual/on)\n            motion-active?  (contains? @active :motion/active)\n            br              (or @brightness 0)]\n        [:div {:style {:font-family \"sans-serif\"\n                       :max-width   \"340px\"\n                       :margin      \"40px auto\"\n                       :text-align  \"center\"}}\n         [:h1 \"Lighting System\"]\n\n         [bulb br]\n\n         [:div {:style {:font-size   \"18px\"\n                        :font-weight \"bold\"\n                        :margin      \"8px 0 4px\"\n                        :color       (if (pos? br) \"#c8a000\" \"#999\")}}\n          (if (pos? br) \"ON\" \"OFF\")]\n\n         [:div {:style {:font-size \"13px\" :color \"#666\" :margin-bottom \"20px\"}}\n          (str \"Brightness: \" br \"%\")]\n\n         [:div {:style {:background    \"#f5f5f5\"\n                        :border-radius \"8px\"\n                        :padding       \"16px\"\n                        :margin-bottom \"16px\"}}\n          [:div {:style {:font-size \"13px\" :color \"#888\" :margin-bottom \"10px\"}}\n           \"Mode\"]\n          [:div {:style {:font-size \"16px\" :font-weight \"bold\" :margin-bottom \"12px\"}}\n           (cond manual?         \"Manual\"\n                 motion-sensing? \"Motion Sensing\")]\n          (if manual?\n            [:div\n             [btn \"Toggle Light\" :toggle]\n             [btn \"Change Brightness\" :change-brightness {:disabled? (not manual-on?)}]\n             [btn \"Switch to Motion Sensing\" :switch-to-motion]]\n            [:div\n             [btn \"Simulate Motion\" :motion-detected {:disabled? motion-active?}]\n             [:div {:style {:font-size \"12px\" :color \"#888\" :margin \"6px 0\"}}\n              (if motion-active?\n                \"Light will turn off after 5 seconds\"\n                \"Waiting for motion...\")]\n             [btn \"Switch to Manual\" :switch-to-manual]])]\n\n         [:div {:style {:margin-top \"8px\"}}\n          [:button {:style small-button-style\n                    :on-click #(pprint (tree))}\n           \"statechart\"]\n          [:button {:style small-button-style\n                    :on-click #(pprint (dissoc @app-db :tree :active-states :parents))}\n           \"db\"]\n          [:button {:style small-button-style\n                    :on-click show-active-states}\n           \"active states\"]]]))))\n"]}