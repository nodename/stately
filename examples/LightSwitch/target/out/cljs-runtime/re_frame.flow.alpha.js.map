{"version":3,"sources":["re_frame/flow/alpha.cljc"],"mappings":"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","names":["re-frame.flow.alpha/db-path?","cljs.core/vector?","re-frame.flow.alpha/flow?","cljs.core/map?","re-frame.flow.alpha/flow<-?","cljs.core.comp","cljs.core/some?","re-frame.flow.alpha/flows","re-frame.interop/ratom","re-frame.flow.alpha/flow-states","cljs.core.atom","p__35541","map__35542","cljs.core/--destructure-map","cljs.core.get","re-frame.flow.alpha/input-ids","inputs","live-inputs","cljs.core/vec","cljs.core.distinct","cljs.core.into","cljs.core.remove","p1__35534#","cljs.core.map","or__5002__auto__","cljs.core.concat","cljs.core/vals","re-frame.flow.alpha/topsort","flows","re-frame.utils/map-vals","re-frame.utils/remove-orphans","re-frame.utils/topsort-kahn","cljs.core/reverse","re-frame.flow.alpha/topsort*","re-frame.utils/memoize-one","re-frame.flow.alpha/default","id","cljs.core/sequential?","cljs.core/constantly","re-frame.utils/deep-dissoc","p__35575","map__35576","re-frame.flow.alpha/stale-in-flows","cljs.core/reduce-kv","p__35584","map__35585","m","k","path","G__35586","cljs.core/contains?","cljs.core/set","cljs.core.assoc","p__35600","map__35601","re-frame.flow.alpha/stale-out-flows","p__35611","map__35612","bad-inputs","cljs.core.filter","cljs.core/val","G__35618","cljs.core/seq","p__35632","map__35633","re-frame.flow.alpha/validate-inputs","seq__35634","chunk__35636","count__35637","i__35638","vec__35655","cljs.core.nth","temp__5804__auto__","cljs.core/chunked-seq?","c__5525__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/count","vec__35661","cljs.core/first","cljs.core/next","_","input","cljs.core/not","cljs.core.some_fn","js/Error","re-frame.flow.alpha/warn-stale-dependencies","new-flow","ins","outs","warn-ins","p__35670","vec__35672","warn-outs","p__35676","vec__35677","cljs.core.mapcat","p__35680","vec__35683","input-id","warnings","cljs.core.apply","re-frame.loggers/console","var_args","G__35697","re-frame.flow.alpha/reg-flow","re_frame.flow.alpha.reg_flow","cljs.core/deref","cljs.core.swap_BANG_","cljs.core/update","cljs.core.fnil","cljs.core/conj","cljs.core/assoc","cljs.core.merge","cljs.core/with-meta","reagent.ratom/make-reaction","cljs.core.get_in","re-frame.db/app-db","G__35719","re-frame.flow.alpha/clear-flow","cljs.core/empty","cljs.core/into","flow","cljs.core/dissoc","re-frame.flow.alpha/flow<-","re-frame.flow.alpha/flow-fx-ids","p__35724","vec__35727","re-frame.flow.alpha/do-effect","v","handler","G__35731","cljs.core/Keyword","re-frame.flow.alpha/remove-fx","cljs.core.partial","cljs.core/remove","p1__35737#","re-frame.flow.alpha/dissoc-fx","re-frame.flow.alpha/do-fx","re_frame.interceptor.__GT_interceptor","p__35743","map__35744","map__35745","fx","effects","ctx","flow-fx","cljs.core/select-keys","cljs.core/filterv","cljs.core.doall","cljs.core.update_in","cljs.core.update","re-frame.flow.alpha/resolve-input","db","G__35750","re-frame.flow.alpha/resolve-inputs","cljs.core/empty?","p__35766","map__35767","re-frame.flow.alpha/run","cleanup","live?","output","cleared?","new?","old-db","re_frame.interceptor.get_coeffect","re_frame.interceptor.get_effect","id->old-in","id->in","dirty?","cljs.core.not_EQ_","id->old-live-in","id->live-in","old-output","bardo","G__35776","G__35777","new-db","G__35778","cljs.core._EQ_","G__35780","cljs.core/assoc-in","cljs.core/disj","new-fx","G__35785","re-frame.trace/is-trace-enabled?","*current-trace*-orig-val__35791","re-frame.trace/*current-trace*","*current-trace*-temp-val__35792","re-frame.trace/start-trace","end__12884__auto__","re-frame.interop/now","duration__12885__auto__","re-frame.trace/traces","re-frame.trace/run-tracing-callbacks!","G__35798","G__35801","re-frame.interceptor/assoc-effect","re-frame.flow.alpha/with-cleared","p1__35805#","cljs.core/update-vals","re-frame.flow.alpha/interceptor","all-flows","cljs.core.reduce","p__35821","map__35823","map__35824"],"sourcesContent":["(ns re-frame.flow.alpha\n  (:require\n   #?(:cljs [re-frame.db :as db])\n   [re-frame.utils :as u]\n   [re-frame.registrar :refer [get-handler]]\n   [re-frame.loggers     :refer [console]]\n   [re-frame.interceptor :refer [->interceptor get-effect\n                                 get-coeffect assoc-effect]]\n   [re-frame.interop :as interop]\n   [re-frame.trace :as trace :include-macros true]\n   #?(:cljs [reagent.core :as r])))\n\n(def db-path? vector?)\n\n(def flow? map?)\n\n(def flow<-? (comp some? ::flow<-))\n\n(def flows (interop/ratom {}))\n\n(def flow-states (atom {}))\n\n(defn input-ids [{:keys [inputs live-inputs]}]\n  (vec (distinct (into []\n                       (comp (remove db-path?)\n                             (map #(or (::flow<- %) %)))\n                       (concat (vals inputs) (vals live-inputs))))))\n\n(defn topsort [flows]\n  (->> flows\n       (u/map-vals input-ids)\n       u/remove-orphans\n       u/topsort-kahn\n       reverse\n       (map flows)))\n\n(def topsort* (u/memoize-one topsort))\n\n(defn default [id]\n  {:id          id\n   :path        (if (sequential? id) (vec id) [id])\n   :inputs      {}\n   :output      (constantly true)\n   :live?       (constantly true)\n   :live-inputs {}\n   :cleanup     u/deep-dissoc})\n\n(defn stale-in-flows [flows {:keys [inputs]}]\n  (reduce-kv (fn [m k {:keys [path]}]\n               (cond-> m\n                 (contains? (set (vals inputs)) path) (assoc k path)))\n             {}\n             flows))\n\n(defn stale-out-flows [flows {:keys [path]}]\n  (reduce-kv (fn [m k {:keys [inputs]}]\n               (let [bad-inputs (into {} (filter (comp #{path} val)) inputs)]\n                 (cond-> m (seq bad-inputs) (assoc k bad-inputs))))\n             {}\n             flows))\n\n(defn validate-inputs [{:keys [inputs]}]\n  (doseq [[_ input] inputs\n          :when (not ((some-fn db-path? flow<-?) input))]\n    (throw (#?(:clj Exception. :cljs js/Error.) \"bad input\"))))\n\n(defn warn-stale-dependencies [flows new-flow]\n  (let [ins (stale-in-flows flows new-flow)\n        outs (stale-out-flows flows new-flow)\n        warn-ins (fn [[id path]]\n                   [\"- Input\" (str path)\n                    \"matches the output path of\" (str id) \".\\n\"\n                    \"  For an explicit dependency, change it to (re-frame/flow<-\"\n                    (str id \").\") \"\\n\"])\n        warn-outs (fn [[id inputs]]\n                    (mapcat (fn [[input-id _]]\n                              [\"- Output\" (str (:path new-flow))\n                               \"matches the input\" (str input-id)\n                               \"of the flow\" (str id \".\\n\")\n                               \"  For an explicit dependency, change that input to\"\n                               \"(re-frame/flow<-\" (str (:id new-flow) \").\") \"\\n\"])\n                            inputs))\n        warnings (concat (mapcat warn-ins ins) (mapcat warn-outs outs))]\n    (when (seq warnings)\n      (apply console :warn \"Warning: You called `reg-flow` with the flow\" (str (:id new-flow))\n             \"but this created stale dependencies.\\n\"\n             \"Your flows may not evaluate in the correct order.\\n\"\n             warnings))))\n\n(defn reg-flow\n  ([k m]\n   (reg-flow (assoc m :id k)))\n  ([m]\n   (validate-inputs m)\n   (warn-stale-dependencies @flows m)\n   (swap! flow-states update ::registered (fnil conj #{}) (:id m))\n   (swap! flows assoc (:id m)\n          (-> (merge (default (:id m)) m)\n              (with-meta #?(:cljs\n                            {::ref (r/reaction (get-in @db/app-db (:path m)))}))))))\n\n(defn clear-flow\n  ([]\n   (swap! flows empty)\n   (swap! flow-states update ::cleared into @flows))\n  ([id]\n   (when-let [flow (get @flows id)]\n     (swap! flows dissoc id)\n     (swap! flow-states update ::cleared assoc (:id flow) flow))))\n\n(defn flow<- [id] {::flow<- id})\n\n(def flow-fx-ids #{:reg-flow :clear-flow})\n\n(defn do-effect [[k v]]\n  (let [handler (case k :reg-flow reg-flow :clear-flow clear-flow)]\n    (handler v)))\n\n(def remove-fx (partial remove (comp flow-fx-ids first)))\n\n(def dissoc-fx #(apply dissoc % flow-fx-ids))\n\n(def do-fx\n  (->interceptor\n   {:id :do-flow-fx\n    :after (fn [{{:keys [fx] :as effects} :effects\n                 :as ctx}]\n             (let [flow-fx (concat (select-keys effects flow-fx-ids)\n                                   (filterv (comp flow-fx-ids first) fx))]\n               (doall (map do-effect flow-fx))\n               (-> ctx\n                   (update-in [:effects :fx] remove-fx)\n                   (update :effects dissoc-fx))))}))\n\n(defn resolve-input [db flows input]\n  (if (vector? input)\n    (get-in db input)\n    (some->> input ::flow<- flows :path (resolve-input db flows))))\n\n(defn resolve-inputs [db flows inputs]\n  (if (empty? inputs) db (u/map-vals (partial resolve-input db flows) inputs)))\n\n(defn run [ctx {:keys   [path cleanup live? inputs live-inputs output id]\n                flow-fx :fx\n                ::keys  [cleared?]\n                :as     flow}]\n  (let [new?   (contains? (::registered @flow-states) id)\n        old-db (get-coeffect ctx :db)\n        db     (or (get-effect ctx :db) old-db)\n        fx     (get-effect ctx :fx)\n\n        id->old-in (resolve-inputs old-db (:flows ctx) inputs)\n        id->in     (resolve-inputs db (:flows ctx) inputs)\n        dirty?     (not= id->in id->old-in)\n\n        id->old-live-in (resolve-inputs old-db (:flows ctx) live-inputs)\n        id->live-in     (resolve-inputs db (:flows ctx) live-inputs)\n\n        old-output (get-in old-db path)\n\n        bardo [(cond new? :registered (live? (assoc id->old-live-in :db old-db)) :live :else :dead)\n               (cond cleared? :cleared (live? (assoc id->live-in :db db)) :live :else :dead)]\n\n        new-db (case bardo\n                 [:live :live]       (cond-> db dirty? (assoc-in path (output id->in id->old-in old-output)))\n                 [:live :dead]       (cleanup db path)\n                 [:dead :live]       (assoc-in db path (output id->in id->old-in old-output))\n                 [:registered :live] (do (swap! flow-states update ::registered disj id)\n                                            (assoc-in db path (output id->in id->old-in old-output)))\n                 [:live :cleared]    (cleanup db path)\n                 nil)\n\n        new-fx (when flow-fx\n                 (case bardo\n                   [:live :live]       (when dirty? (concat fx (flow-fx id->in id->old-in old-output)))\n                   [:dead :live]       (concat fx (flow-fx id->in id->old-in old-output))\n                   [:registered :live] (concat fx (flow-fx id->in id->old-in old-output))\n                   nil))]\n    (trace/with-trace {:operation id\n                       :op-type   :flow\n                       :tags      {:flow-spec       flow\n                                   :transition      bardo\n                                   :db              db\n                                   :new-db          new-db\n                                   :id->in          id->in\n                                   :id->old-in      id->old-in\n                                   :id->live-in     id->live-in\n                                   :id->old-live-in id->old-live-in}}\n      (cond-> ctx\n        new-db (assoc-effect :db new-db)\n        new-fx (assoc-effect :fx new-fx)))))\n\n(defn with-cleared [m]\n  (merge (update-vals (::cleared @flow-states) #(assoc % ::cleared? true)) m))\n\n(def interceptor\n  (->interceptor\n   {:id    :flow\n    :after (comp (fn [ctx]\n                   (let [all-flows (with-cleared @flows)]\n                     (swap! flow-states dissoc ::cleared)\n                     (reduce run\n                             (assoc ctx :flows all-flows)\n                             (topsort* all-flows))))\n                 (fn [{{:keys [db]} :effects :as ctx}]\n                   (assoc ctx :re-frame/pre-flow-db db)))}))\n"],"x_google_ignoreList":[0]}